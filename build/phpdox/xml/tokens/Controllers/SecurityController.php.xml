<?xml version="1.0"?>
<source xmlns="http://xml.phpdox.net/token">
  <file xmlns="http://xml.phpdox.net/src" path="src/Controllers" file="SecurityController.php" realpath="/var/www/html/cms/src/Controllers/SecurityController.php" size="1841" time="2016-04-01T22:06:46+00:00" unixtime="1459548406" sha1="5e93458dcba7c0c5c84aa63278df522ff486f89f" relative="Controllers/SecurityController.php"/>
  <line no="1">
    <token name="T_OPEN_TAG">&lt;?php</token>
  </line>
  <line no="2"/>
  <line no="3">
    <token name="T_NAMESPACE">namespace</token>
    <token name="T_WHITESPACE"> </token>
    <token name="T_STRING">CMS</token>
    <token name="T_NS_SEPARATOR">\</token>
    <token name="T_STRING">Controllers</token>
    <token name="T_PHPDOX_SEMICOLON">;</token>
  </line>
  <line no="4"/>
  <line no="5">
    <token name="T_USE">use</token>
    <token name="T_WHITESPACE"> </token>
    <token name="T_STRING">Silex</token>
    <token name="T_NS_SEPARATOR">\</token>
    <token name="T_STRING">Application</token>
    <token name="T_PHPDOX_SEMICOLON">;</token>
  </line>
  <line no="6">
    <token name="T_USE">use</token>
    <token name="T_WHITESPACE"> </token>
    <token name="T_STRING">Symfony</token>
    <token name="T_NS_SEPARATOR">\</token>
    <token name="T_STRING">Component</token>
    <token name="T_NS_SEPARATOR">\</token>
    <token name="T_STRING">HttpFoundation</token>
    <token name="T_NS_SEPARATOR">\</token>
    <token name="T_STRING">Request</token>
    <token name="T_PHPDOX_SEMICOLON">;</token>
  </line>
  <line no="7"/>
  <line no="8">
    <token name="T_DOC_COMMENT">/**</token>
  </line>
  <line no="9">
    <token name="T_DOC_COMMENT"> * The security controller responsible for logging in.</token>
  </line>
  <line no="10">
    <token name="T_DOC_COMMENT"> *</token>
  </line>
  <line no="11">
    <token name="T_DOC_COMMENT"> * @class SecurityController</token>
  </line>
  <line no="12">
    <token name="T_DOC_COMMENT"> */</token>
  </line>
  <line no="13">
    <token name="T_CLASS">class</token>
    <token name="T_WHITESPACE"> </token>
    <token name="T_STRING">SecurityController</token>
  </line>
  <line no="14">
    <token name="T_PHPDOX_OPEN_CURLY">{</token>
  </line>
  <line no="15">
    <token name="T_WHITESPACE">    </token>
    <token name="T_DOC_COMMENT">/**</token>
  </line>
  <line no="16">
    <token name="T_DOC_COMMENT">     * A controller to handle logging in.</token>
  </line>
  <line no="17">
    <token name="T_DOC_COMMENT">     *</token>
  </line>
  <line no="18">
    <token name="T_DOC_COMMENT">     * @param Request     $request current request object</token>
  </line>
  <line no="19">
    <token name="T_DOC_COMMENT">     * @param Application $app     current app instance</token>
  </line>
  <line no="20">
    <token name="T_DOC_COMMENT">     *</token>
  </line>
  <line no="21">
    <token name="T_DOC_COMMENT">     * @return twig template        a log in form</token>
  </line>
  <line no="22">
    <token name="T_DOC_COMMENT">     */</token>
  </line>
  <line no="23">
    <token name="T_WHITESPACE">    </token>
    <token name="T_PUBLIC">public</token>
    <token name="T_WHITESPACE"> </token>
    <token name="T_FUNCTION">function</token>
    <token name="T_WHITESPACE"> </token>
    <token name="T_STRING">logInAction</token>
    <token name="T_PHPDOX_OPEN_BRACKET">(</token>
    <token name="T_STRING">Request</token>
    <token name="T_WHITESPACE"> </token>
    <token name="T_VARIABLE">$request</token>
    <token name="T_PHPDOX_COMMA">,</token>
    <token name="T_WHITESPACE"> </token>
    <token name="T_STRING">Application</token>
    <token name="T_WHITESPACE"> </token>
    <token name="T_VARIABLE">$app</token>
    <token name="T_PHPDOX_CLOSE_BRACKET">)</token>
  </line>
  <line no="24">
    <token name="T_WHITESPACE">    </token>
    <token name="T_PHPDOX_OPEN_CURLY">{</token>
  </line>
  <line no="25">
    <token name="T_WHITESPACE">        </token>
    <token name="T_VARIABLE">$args_array</token>
    <token name="T_WHITESPACE"> </token>
    <token name="T_PHPDOX_EQUAL">=</token>
    <token name="T_WHITESPACE"> </token>
    <token name="T_ARRAY">array</token>
    <token name="T_PHPDOX_OPEN_BRACKET">(</token>
  </line>
  <line no="26">
    <token name="T_WHITESPACE">            </token>
    <token name="T_CONSTANT_ENCAPSED_STRING">'error'</token>
    <token name="T_WHITESPACE"> </token>
    <token name="T_DOUBLE_ARROW">=&gt;</token>
    <token name="T_WHITESPACE"> </token>
    <token name="T_VARIABLE">$app</token>
    <token name="T_PHPDOX_OPEN_SQUARE">[</token>
    <token name="T_CONSTANT_ENCAPSED_STRING">'security.last_error'</token>
    <token name="T_PHPDOX_CLOSE_SQUARE">]</token>
    <token name="T_PHPDOX_OPEN_BRACKET">(</token>
    <token name="T_VARIABLE">$request</token>
    <token name="T_PHPDOX_CLOSE_BRACKET">)</token>
    <token name="T_PHPDOX_COMMA">,</token>
  </line>
  <line no="27">
    <token name="T_WHITESPACE">            </token>
    <token name="T_CONSTANT_ENCAPSED_STRING">'last_username'</token>
    <token name="T_WHITESPACE"> </token>
    <token name="T_DOUBLE_ARROW">=&gt;</token>
    <token name="T_WHITESPACE"> </token>
    <token name="T_VARIABLE">$app</token>
    <token name="T_PHPDOX_OPEN_SQUARE">[</token>
    <token name="T_CONSTANT_ENCAPSED_STRING">'session'</token>
    <token name="T_PHPDOX_CLOSE_SQUARE">]</token>
    <token name="T_OBJECT_OPERATOR">-&gt;</token>
    <token name="T_STRING">get</token>
    <token name="T_PHPDOX_OPEN_BRACKET">(</token>
    <token name="T_CONSTANT_ENCAPSED_STRING">'_security.last_username'</token>
    <token name="T_PHPDOX_CLOSE_BRACKET">)</token>
    <token name="T_PHPDOX_COMMA">,</token>
  </line>
  <line no="28">
    <token name="T_WHITESPACE">        </token>
    <token name="T_PHPDOX_CLOSE_BRACKET">)</token>
    <token name="T_PHPDOX_SEMICOLON">;</token>
  </line>
  <line no="29">
    <token name="T_WHITESPACE">        </token>
    <token name="T_VARIABLE">$templateName</token>
    <token name="T_WHITESPACE"> </token>
    <token name="T_PHPDOX_EQUAL">=</token>
    <token name="T_WHITESPACE"> </token>
    <token name="T_CONSTANT_ENCAPSED_STRING">'login'</token>
    <token name="T_PHPDOX_SEMICOLON">;</token>
  </line>
  <line no="30"/>
  <line no="31">
    <token name="T_WHITESPACE">        </token>
    <token name="T_RETURN">return</token>
    <token name="T_WHITESPACE"> </token>
    <token name="T_VARIABLE">$app</token>
    <token name="T_PHPDOX_OPEN_SQUARE">[</token>
    <token name="T_CONSTANT_ENCAPSED_STRING">'twig'</token>
    <token name="T_PHPDOX_CLOSE_SQUARE">]</token>
    <token name="T_OBJECT_OPERATOR">-&gt;</token>
    <token name="T_STRING">render</token>
    <token name="T_PHPDOX_OPEN_BRACKET">(</token>
    <token name="T_VARIABLE">$templateName</token>
    <token name="T_PHPDOX_DOT">.</token>
    <token name="T_CONSTANT_ENCAPSED_STRING">'.html.twig'</token>
    <token name="T_PHPDOX_COMMA">,</token>
    <token name="T_WHITESPACE"> </token>
    <token name="T_VARIABLE">$args_array</token>
    <token name="T_PHPDOX_CLOSE_BRACKET">)</token>
    <token name="T_PHPDOX_SEMICOLON">;</token>
  </line>
  <line no="32">
    <token name="T_WHITESPACE">    </token>
    <token name="T_PHPDOX_CLOSE_CURLY">}</token>
  </line>
  <line no="33">
    <token name="T_WHITESPACE">    </token>
    <token name="T_COMMENT">// public function loginCheckAction(Request $request, Application $app)</token>
  </line>
  <line no="34">
    <token name="T_WHITESPACE">    </token>
    <token name="T_COMMENT">// {</token>
  </line>
  <line no="35">
    <token name="T_WHITESPACE">    </token>
    <token name="T_COMMENT">//</token>
  </line>
  <line no="36">
    <token name="T_WHITESPACE">    </token>
    <token name="T_COMMENT">// $username = $request-&gt;get('username');</token>
  </line>
  <line no="37">
    <token name="T_WHITESPACE">    </token>
    <token name="T_COMMENT">// $password = $request-&gt;get('password');</token>
  </line>
  <line no="38">
    <token name="T_WHITESPACE">    </token>
    <token name="T_COMMENT">//</token>
  </line>
  <line no="39">
    <token name="T_WHITESPACE">    </token>
    <token name="T_COMMENT">// $userProvider = new CustomUserProvider();</token>
  </line>
  <line no="40">
    <token name="T_WHITESPACE">    </token>
    <token name="T_COMMENT">// $user = $userProvider-&gt;loadUserbyUsername($username);</token>
  </line>
  <line no="41">
    <token name="T_WHITESPACE">    </token>
    <token name="T_COMMENT">// var_dump($user);</token>
  </line>
  <line no="42">
    <token name="T_WHITESPACE">    </token>
    <token name="T_COMMENT">// if ($user-&gt;getPassword() == $password){</token>
  </line>
  <line no="43">
    <token name="T_WHITESPACE">    </token>
    <token name="T_COMMENT">//     return $app['twig']-&gt;render('admin/dashboard.html.twig');</token>
  </line>
  <line no="44">
    <token name="T_WHITESPACE">    </token>
    <token name="T_COMMENT">// }</token>
  </line>
  <line no="45">
    <token name="T_WHITESPACE">    </token>
    <token name="T_COMMENT">// else{</token>
  </line>
  <line no="46">
    <token name="T_WHITESPACE">    </token>
    <token name="T_COMMENT">//     return $app['twig']-&gt;render('login.html.twig', array(</token>
  </line>
  <line no="47">
    <token name="T_WHITESPACE">    </token>
    <token name="T_COMMENT">//         'error' =&gt; $app['security.last_error']($request),</token>
  </line>
  <line no="48">
    <token name="T_WHITESPACE">    </token>
    <token name="T_COMMENT">//         'last_username' =&gt; $app['session']-&gt;get('_security.last_username'),</token>
  </line>
  <line no="49">
    <token name="T_WHITESPACE">    </token>
    <token name="T_COMMENT">//     ));</token>
  </line>
  <line no="50">
    <token name="T_WHITESPACE">    </token>
    <token name="T_COMMENT">// }</token>
  </line>
  <line no="51"/>
  <line no="52">
    <token name="T_WHITESPACE">    </token>
    <token name="T_COMMENT">//     $args_array = array();</token>
  </line>
  <line no="53">
    <token name="T_WHITESPACE">    </token>
    <token name="T_COMMENT">//     $templateName = 'admin/dashboard';</token>
  </line>
  <line no="54">
    <token name="T_WHITESPACE">    </token>
    <token name="T_COMMENT">//</token>
  </line>
  <line no="55">
    <token name="T_WHITESPACE">    </token>
    <token name="T_COMMENT">//     return $app['twig']-&gt;render($templateName.'.html.twig', $args_array);</token>
  </line>
  <line no="56">
    <token name="T_WHITESPACE">    </token>
    <token name="T_COMMENT">//</token>
  </line>
  <line no="57">
    <token name="T_WHITESPACE">    </token>
    <token name="T_COMMENT">// }</token>
  </line>
  <line no="58">
    <token name="T_WHITESPACE">    </token>
    <token name="T_PUBLIC">public</token>
    <token name="T_WHITESPACE"> </token>
    <token name="T_FUNCTION">function</token>
    <token name="T_WHITESPACE"> </token>
    <token name="T_STRING">logoutAction</token>
    <token name="T_PHPDOX_OPEN_BRACKET">(</token>
    <token name="T_STRING">Request</token>
    <token name="T_WHITESPACE"> </token>
    <token name="T_VARIABLE">$request</token>
    <token name="T_PHPDOX_COMMA">,</token>
    <token name="T_WHITESPACE"> </token>
    <token name="T_STRING">Application</token>
    <token name="T_WHITESPACE"> </token>
    <token name="T_VARIABLE">$app</token>
    <token name="T_PHPDOX_CLOSE_BRACKET">)</token>
  </line>
  <line no="59">
    <token name="T_WHITESPACE">    </token>
    <token name="T_PHPDOX_OPEN_CURLY">{</token>
  </line>
  <line no="60">
    <token name="T_WHITESPACE">        </token>
    <token name="T_RETURN">return</token>
    <token name="T_WHITESPACE"> </token>
    <token name="T_VARIABLE">$app</token>
    <token name="T_OBJECT_OPERATOR">-&gt;</token>
    <token name="T_STRING">redirect</token>
    <token name="T_PHPDOX_OPEN_BRACKET">(</token>
    <token name="T_CONSTANT_ENCAPSED_STRING">'/'</token>
    <token name="T_PHPDOX_CLOSE_BRACKET">)</token>
    <token name="T_PHPDOX_SEMICOLON">;</token>
  </line>
  <line no="61">
    <token name="T_WHITESPACE">    </token>
    <token name="T_PHPDOX_CLOSE_CURLY">}</token>
  </line>
  <line no="62">
    <token name="T_PHPDOX_CLOSE_CURLY">}</token>
  </line>
  <line no="63"/>
</source>
